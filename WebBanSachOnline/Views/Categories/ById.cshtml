

@model IEnumerable<WebBanSachOnline.Models.Book>
@{
    ViewBag.Title = "ById";
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Danh Mục Sách - Nhà Sách Online</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
          rel="stylesheet" />
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          rel="stylesheet" />
    <!-- Custom CSS -->
    <link href="~/Content/style.css" rel="stylesheet" />
</head>
<body>


    <!-- Main Content -->
    <div class="container mt-4">
        <nav aria-label="breadcrumb" class="bg-light p-2 rounded mb-4 shadow-sm">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item">
                    <a href="/">Trang chủ</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    Danh mục sách
                </li>
            </ol>
        </nav>


        <div class="row">
            <!-- Filters -->
            <div class="col-lg-3">
                <!-- Categories -->

                <div class="card-body">
                    <div class="list-group list-group-flush">

                        @{ Html.RenderAction("Menu2", "Categories");}

                    </div>
                </div>


                <!-- Price Range -->
                <!--<div class="card shadow-sm mb-4">
                <div class="card-header bg-white">
                    <h5 class="card-title mb-0">Giá</h5>
                </div>
                <div class="card-body">
                    <div class="form-check mb-2">
                        <input class="form-check-input"
                               type="radio"
                               name="priceRange"
                               id="price1"
                               value="0-100000"
                               checked />
                        <label class="form-check-label" for="price1">
                            Dưới 100.000₫
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input"
                               type="radio"
                               name="priceRange"
                               id="price2"
                               value="100000-200000" />
                        <label class="form-check-label" for="price2">
                            100.000₫ - 200.000₫
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input"
                               type="radio"
                               name="priceRange"
                               id="price3"
                               value="200000-500000" />
                        <label class="form-check-label" for="price3">
                            200.000₫ - 500.000₫
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input"
                               type="radio"
                               name="priceRange"
                               id="price4"
                               value="500000-" />
                        <label class="form-check-label" for="price4">
                            Trên 500.000₫
                        </label>
                    </div>
                </div>
            </div>-->




            </div>

            <!-- Book List -->
            <div class="col-lg-9">
                <!-- Search and Sort Options -->
                <!--<div class="card shadow-sm mb-4">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <div class="input-group">
                                <input type="text"
                                       class="form-control"
                                       placeholder="Tìm kiếm sách..."
                                       id="search-input" />
                                <button class="btn btn-primary"
                                        type="button"
                                        onclick="searchBooks()">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6 text-md-end">
                            <select class="form-select"
                                    id="sort-select"
                                    onchange="sortBooks(this.value)">
                                <option value="newest">Mới nhất</option>
                                <option value="bestseller">Bán chạy nhất</option>
                                <option value="price-asc">Giá tăng dần</option>
                                <option value="price-desc">Giá giảm dần</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>-->
                <!-- View Options -->
                <!-- Books Grid -->
                <div class="row g-4" id="books-container">
                    <!-- Books will be loaded here -->

                    @foreach (var item in Model)

                    {

                        string imagePath = "~/BookImages/" + item.image;
                        <div class="col-md-4 col-sm-6">
                            <div class="card h-100 book-card">
                                <div class="book-image-container">
                                    <img src="@Url.Content(imagePath)" class="card-img-top " height="350px" alt=@item.title>
                                </div>
                                <div class="card-body">
                                    <h5 class="card-title">@item.title</h5>
                                    <div class="d-flex align-items-center mb-2">
                                    </div>
                                    <div>
                                        @if (item.quantity - item.soldQuantity > 0)
                                        {
                                            <span>
                                                Còn: @(item.quantity - item.soldQuantity)
                                            </span>
                                        }
                                        else
                                        {
                                            <span>Hết hàng</span>
                                        }

                                    </div>
                                    <div class="price-container">
                                        <span class="original-price" style="text-decoration:line-through; ">
                                            @string.Format("{0:N0} đ", item.originalPrice)
                                        </span>
                                        <span class="current-price" style="color:red">
                                            @string.Format("{0:N0} đ", item.price)
                                        </span>
                                    </div>
                                    <div class="d-grid mt-2">
                                        <a href="@Url.Action("Details", "Books", new { slug = item.slug })" class="btn btn-primary w-100">Xem chi tiết</a>
                                        @if (item.quantity - item.soldQuantity > 0)
                                        {
                                            <a href="@Url.Action("AddToCart", "CartItems", new { bookId = item.id })" class="AddToCartBtn btn btn-danger w-100">
                                                Thêm vào giỏ
                                            </a>
                                        }
                                        else
                                        {
                                            <a href="@Url.Action("AddToCart", "CartItems", new { bookId = item.id })" class="AddToCartBtn btn btn-danger w-100 disabled">
                                                Thêm vào giỏ
                                            </a>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>

                    }



                    <!-- Pagination -->
                    <nav class="mt-4" aria-label="Books pagination">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Trước</a>
                            </li>
                            <li class="page-item active" aria-current="page">
                                <a class="page-link" href="#">1</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">2</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">3</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">Sau</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>



        <!-- Toast Container -->
        <div id="toast-container"
             class="position-fixed bottom-0 end-0 p-3"
             style="z-index: 1100">
            <!-- Toasts will be appended here -->
        </div>

        <!-- Bootstrap JS Bundle (includes Popper) -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
        <script>
            document.querySelectorAll('.AddToCartBtn').forEach(btn => {
                btn.addEventListener('click', function (e) {
                    e.preventDefault(); // Ngăn tải trang
                    fetch(this.href)
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) alert('Đã thêm vào giỏ hàng!');
                            else alert('Lỗi thêm giỏ hàng');
                        })
                        .catch(() => alert('Lỗi kết nối'));
                });
            });
        </script>
</body>
</html>


